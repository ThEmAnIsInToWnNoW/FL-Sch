<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>School Bell Schedule & Countdown</title>
<style>
    :root {
        --bg-color: #f4f4f9;
        --text-color: #333;
        --header-bg: #800000;
        --header-text: white;
        --card-bg: white;
        --border-color: #ccc;
        --current-period-bg: #d4edda;
        --current-period-text: #155724;
        --next-period-bg: #fff3cd;
        --next-period-text: #856404;
        --button-bg: #800000;
        --button-text: white;
        --current-time-color: #4CAF50;
    }
    .dark-mode {
        --bg-color: #121212;
        --text-color: #e0e0e0;
        --header-bg: #e0e0e0;
        --header-text: #121212;
        --card-bg: #1e1e1e;
        --border-color: #333;
        --current-period-bg: #1c3d25;
        --current-period-text: #a8dadc;
        --next-period-bg: #3e381d;
        --next-period-text: #ffd54f;
        --button-bg: #e0e0e0;
        --button-text: #121212;
        --current-time-color: #66bb6a;
    }
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
        background-color: var(--bg-color);
        color: var(--text-color);
    }
    #share-button, #theme-toggle {
        position: fixed;
        top: 20px;
        padding: 10px 15px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-weight: bold;
        background-color: var(--button-bg);
        color: var(--button-text);
        transition: 0.3s;
        z-index: 1000;
    }
    #share-button { left: 20px; }
    #theme-toggle { right: 20px; }
    #share-button:hover, #theme-toggle:hover { opacity: 0.8; }
    .container {
        max-width: 1000px;
        margin: 0 auto;
        background: var(--card-bg);
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        border: 1px solid var(--border-color);
    }
    h1 {
        color: var(--header-bg);
        border-bottom: 2px solid var(--border-color);
        padding-bottom: 10px;
    }
    #current-time {
        font-size: 1.8em;
        color: var(--current-time-color);
    }
    #current-period, #time-left { font-size: 1.2em; margin: 5px 0; }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
    }
    th, td {
        border: 1px solid var(--border-color);
        padding: 10px;
        text-align: left;
    }
    th {
        background-color: var(--header-bg);
        color: var(--header-text);
    }
    tr:nth-child(even) { background-color: rgba(128, 0, 0, 0.05); }
    .highlight-cell {
        background-color: var(--current-period-bg) !important;
        color: var(--current-period-text) !important;
        font-weight: bold;
    }

    /* Share popup */
    .share-overlay {
        display: none;
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        background: rgba(0,0,0,0.5);
        z-index: 1999;
    }
    .share-overlay.active { display: block; }
    .share-popup {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: var(--card-bg);
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        z-index: 2000;
        max-width: 500px;
        width: 90%;
    }
    .share-popup.active { display: block; }
    .share-option {
        display: flex;
        align-items: center;
        padding: 12px;
        margin: 10px 0;
        background: var(--bg-color);
        border: 1px solid var(--border-color);
        border-radius: 6px;
        cursor: pointer;
        transition: transform 0.2s;
        color: var(--text-color);
    }
    .share-option:hover { transform: scale(1.02); }
    .share-option svg { width: 24px; height: 24px; margin-right: 12px; }
    .close-popup {
        position: absolute;
        top: 10px; right: 15px;
        background: none; border: none;
        font-size: 24px;
        cursor: pointer;
        color: var(--text-color);
    }
</style>
</head>
<body>
<button id="share-button">ðŸ“¤ Share</button>
<button id="theme-toggle">Switch Theme</button>

<div class="share-overlay" id="share-overlay"></div>
<div class="share-popup" id="share-popup">
    <button class="close-popup" id="close-popup">&times;</button>
    <h2>Share or Download</h2>
    <p>Share this page or download it for offline use:</p>

    <div class="share-option" id="copy-link">
        <svg fill="currentColor" viewBox="0 0 24 24"><path d="M3.9,12a5,5,0,0,1,0-7.07L7.76,1.07A5,5,0,0,1,14.83,8.14L13.41,9.55A3,3,0,0,0,8.69,4.83L5.54,8A3,3,0,0,0,9.76,12.2l1.41,1.41A5,5,0,0,1,3.9,12ZM20.1,12a5,5,0,0,0,0,7.07l3.86,3.86A5,5,0,0,0,31.03,15.86L29.62,14.45a3,3,0,0,1-4.72,4.24l-3.15-3.15A3,3,0,0,1,25.31,9.8L23.9,8.39A5,5,0,0,0,20.1,12Z"/></svg>
        <span>Copy Share Link (goofygoobers.xyz)</span>
    </div>

    <div class="share-option" id="download-html">
        <svg fill="currentColor" viewBox="0 0 24 24"><path d="M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"/></svg>
        <span>Download HTML File</span>
    </div>
</div>

<div class="container">
    <h1>Current Status</h1>
    <div id="current-time"></div>
    <div id="current-period">Loading schedule...</div>
    <div id="time-left"></div>

    <h1>Bell Schedule</h1>
    <table id="schedule-table">
        <thead>
            <tr><th>Period</th><th>Mon, Tue, Thu, Fri</th><th>Wednesday</th></tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<script>
const SCHEDULE_DATA = [
    { period: "1", days: "Mon, Tue, Thu, Fri", start: "7:45", end: "8:35" },
    { period: "1", days: "Wed", start: "7:45", end: "8:30" },
    { period: "2", days: "Mon, Tue, Thu, Fri", start: "8:40", end: "9:30" },
    { period: "2", days: "Wed", start: "8:35", end: "9:25" },
    { period: "3", days: "Mon, Tue, Thu, Fri", start: "9:35", end: "10:25" },
    { period: "3", days: "Wed", start: "9:30", end: "10:15" },
    { period: "4", days: "Mon, Tue, Thu, Fri", start: "10:30", end: "11:20" },
    { period: "4", days: "Wed", start: "10:20", end: "11:05" },
    { period: "Ranger Connect", days: "Wed", start: "11:10", end: "11:35" },
    { period: "A Lunch", days: "Mon, Tue, Thu, Fri", start: "11:20", end: "11:50" },
    { period: "B Lunch", days: "Mon, Tue, Thu, Fri", start: "11:45", end: "12:15" },
    { period: "C Lunch", days: "Mon, Tue, Thu, Fri", start: "12:15", end: "12:45" },
    { period: "5", days: "Mon, Tue, Thu, Fri", start: "11:25", end: "12:40" },
    { period: "5", days: "Wed", start: "11:40", end: "12:50" },
    { period: "6", days: "Mon, Tue, Thu, Fri", start: "12:45", end: "13:35" },
    { period: "6", days: "Wed", start: "12:55", end: "13:40" },
    { period: "7", days: "Mon, Tue, Thu, Fri", start: "13:40", end: "14:30" },
    { period: "7", days: "Wed", start: "13:45", end: "14:30" }
];

function timeToMinutes(t){const [h,m]=t.split(':').map(Number);return h*60+m;}
function formatCountdown(mins){const m=Math.floor(mins),s=Math.round((mins-m)*60);return `${m}m ${s.toString().padStart(2,'0')}s`;}

function generateTable(){
    const tbody=document.querySelector('#schedule-table tbody');
    const periods=[["1","7:45â€“8:35","7:45â€“8:30"],["2","8:40â€“9:30","8:35â€“9:25"],["3","9:35â€“10:25","9:30â€“10:15"],
                   ["4","10:30â€“11:20","10:20â€“11:05"],["Ranger Connect","â€”","11:10â€“11:35"],
                   ["5","11:25â€“12:40","11:40â€“12:50"],["A Lunch","11:20â€“11:50","11:35â€“12:05"],
                   ["B Lunch","11:45â€“12:15","12:00â€“12:30"],["C Lunch","12:15â€“12:45","12:25â€“12:55"],
                   ["6","12:45â€“1:35","12:55â€“1:40"],["7","1:40â€“2:30","1:45â€“2:30"]];
    tbody.innerHTML = periods.map(p=>`<tr><td>${p[0]}</td><td>${p[1]}</td><td>${p[2]}</td></tr>`).join('');
}

function updateSchedule(){
    const now=new Date();
    const timeDisplay=document.getElementById('current-time');
    const periodDisplay=document.getElementById('current-period');
    const timeLeftDisplay=document.getElementById('time-left');
    timeDisplay.textContent=now.toLocaleTimeString('en-US',{hour:'2-digit',minute:'2-digit',second:'2-digit'});
    const day=now.getDay();const isWed=day===3;const isWeekend=day===0||day===6;
    document.querySelectorAll('td').forEach(td=>td.classList.remove('highlight-cell'));
    if(isWeekend){periodDisplay.textContent="School is OUT!";timeLeftDisplay.textContent="";return;}
    const nowMin=now.getHours()*60+now.getMinutes()+now.getSeconds()/60;
    if(nowMin>=870){periodDisplay.textContent="School Day Over!";timeLeftDisplay.textContent="See you tomorrow.";return;}
    const filter=isWed?"Wed":"Mon, Tue, Thu, Fri";
    const today=SCHEDULE_DATA.filter(i=>i.days===filter).map(i=>({...i,startMin:timeToMinutes(i.start),endMin:timeToMinutes(i.end)}));
    let current=null,next=null;
    for(const p of today){
        if(nowMin>=p.startMin&&nowMin<p.endMin)current=p;
        else if(nowMin<p.startMin&&!next)next=p;
    }
    if(current){
        const timeLeft=current.endMin-nowMin;
        periodDisplay.textContent=`Current: ${current.period} (ends ${current.end})`;
        timeLeftDisplay.textContent=`Time left: ${formatCountdown(timeLeft)}`;
        const rows=document.querySelectorAll('#schedule-table tbody tr');
        rows.forEach(row=>{
            if(row.cells[0].textContent.trim()===current.period){
                const idx=isWed?2:1;
                row.cells[idx].classList.add('highlight-cell');
            }
        });
    } else if(next){
        const wait=next.startMin-nowMin;
        periodDisplay.textContent="Passing Time / Break";
        timeLeftDisplay.textContent=`Next: ${next.period} in ${formatCountdown(wait)}`;
    } else {
        periodDisplay.textContent="Before School";
        timeLeftDisplay.textContent="Starts at 7:45 AM";
    }
}

function loadTheme(){
    const saved=localStorage.getItem('theme');
    if(saved)document.body.classList.add(saved);
}

const shareButton=document.getElementById('share-button');
const sharePopup=document.getElementById('share-popup');
const shareOverlay=document.getElementById('share-overlay');
const closePopup=document.getElementById('close-popup');
const copyLink=document.getElementById('copy-link');
const downloadHtml=document.getElementById('download-html');

shareButton.onclick=()=>{sharePopup.classList.add('active');shareOverlay.classList.add('active');};
closePopup.onclick=shareOverlay.onclick=()=>{sharePopup.classList.remove('active');shareOverlay.classList.remove('active');};

copyLink.onclick=()=>{
    navigator.clipboard.writeText('https://goofygoobers.xyz').then(()=>{
        copyLink.querySelector('span').textContent='âœ… Link Copied!';
        setTimeout(()=>copyLink.querySelector('span').textContent='Copy Share Link (goofygoobers.xyz)',2000);
    });
};

downloadHtml.onclick=()=>{
    const html=document.documentElement.outerHTML;
    const blob=new Blob([html],{type:'text/html'});
    const url=URL.createObjectURL(blob);
    const a=document.createElement('a');
    a.href=url;a.download='school-schedule.html';a.click();
    URL.revokeObjectURL(url);
};

generateTable();
loadTheme();
updateSchedule();
setInterval(updateSchedule,1000);
</script>
</body>
</html>
